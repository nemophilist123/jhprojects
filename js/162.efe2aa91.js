"use strict";(self["webpackChunkjinghe"]=self["webpackChunkjinghe"]||[]).push([[162],{61162:function(t,e,o){o.r(e),o.d(e,{default:function(){return K}});var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"energyTrendAnalysis"},[e("div",{staticClass:"left border-box tree"},[e("el-tree",{attrs:{"default-expand-all":!0,"expand-on-click-node":!1,data:t.data,props:t.defaultProps},on:{"node-click":t.nodeClick}})],1),e("div",{staticClass:"right border-box"},[e("el-button",{staticStyle:{"background-color":"#0066ff",border:"none","margin-bottom":"0.15rem",width:"1.5rem"},attrs:{type:"primary",icon:"el-icon-plus"},on:{click:t.addInfo}},[t._v("新增")]),e("div",{staticClass:"tabel"},[e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,height:"100%"}},[e("el-table-column",{attrs:{prop:"rationId",label:"关联编号"}}),e("el-table-column",{attrs:{prop:"topName",label:"拓扑图名称"}}),e("el-table-column",{attrs:{label:"拓扑图类型"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t.getTopTypeName(e.row.topType))+" ")]}}])}),e("el-table-column",{attrs:{label:"操作",width:"200"},scopedSlots:t._u([{key:"default",fn:function(o){return[e("el-button",{attrs:{type:"text",size:"small"},on:{click:function(e){return t.editInfo(o.row)}}},[t._v("修改")]),e("el-button",{attrs:{type:"text",size:"small"},on:{click:function(e){return t.deleteInfo(o.row)}}},[t._v("删除")]),e("el-dropdown",{staticStyle:{"margin-left":"10px"}},[e("el-button",{attrs:{type:"text",size:"small"}},[t._v("更多")]),e("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[e("el-dropdown-item",{nativeOn:{click:function(e){return t.toLookParameterConfig(o.row)}}},[t._v("查看")]),e("el-dropdown-item",{nativeOn:{click:function(e){return t.toParameterConfig(o.row)}}},[t._v("参数配置")]),e("el-dropdown-item",{nativeOn:{click:function(e){return t.draw(o.row)}}},[t._v("绘制图表")])],1)],1)]}}])})],1)],1)],1),e("eleDraw",{ref:"eleDrawDialog"}),e("digitalTwinAdd",{ref:"add"}),e("parameterConfigDialog",{ref:"parameterConfig"}),e("lookEleDraw",{ref:"lookEleDrawDialog"})],1)},a=[],r=function(){var t=this,e=t._self._c;return e("div",[e("el-dialog",{attrs:{title:"","close-on-click-modal":!1,visible:t.dialogVisible,modal:!1,width:"95%",top:"3vh"},on:{"update:visible":function(e){t.dialogVisible=e}}},[e("div",{staticClass:"dialog_content",staticStyle:{width:"100%",height:"80vh",overflow:"scroll",background:"#fff"}},[e("iframe",{staticStyle:{width:"100%",height:"100%"},attrs:{src:t.topId,frameborder:"0"}})])])],1)},l=[],n={data(){return{dialogVisible:!1,topId:""}},watch:{},mounted(){},methods:{showDialogFun(t){this.dialogVisible=!0,this.topId="http://"+this.$ipAddress+"/html/apps/topForWeb/dist/index.html?topId="+t}}},s=n,d=o(1001),p=(0,d.Z)(s,r,l,!1,null,"aab64cda",null),c=p.exports,m=function(){var t=this,e=t._self._c;return e("div",[e("el-dialog",{attrs:{title:"","close-on-click-modal":!1,visible:t.dialogVisible,modal:!1,width:"95%",top:"3vh"},on:{"update:visible":function(e){t.dialogVisible=e}}},[e("div",{staticClass:"dialog_content",staticStyle:{width:"100%",height:"80vh",overflow:"scroll",background:"#fff"}},[e("iframe",{staticStyle:{width:"100%",height:"100%"},attrs:{src:t.topId,frameborder:"0"}})])])],1)},u=[],h={data(){return{dialogVisible:!1,topId:""}},watch:{},mounted(){},methods:{showDialogFun(t){this.dialogVisible=!0,this.topId="http://"+this.$ipAddress+"/html/apps/jinghe/index.html?topId="+t}}},f=h,g=(0,d.Z)(f,m,u,!1,null,"360ca4d4",null),b=g.exports,w=function(){var t=this,e=t._self._c;return e("div",[e("el-dialog",{attrs:{title:"",visible:t.dialogFormVisible,modal:!1},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[e("el-form",{attrs:{model:t.form}},[e("el-form-item",{attrs:{label:"拓扑图名称","label-width":t.formLabelWidth}},[e("el-input",{attrs:{autocomplete:"off"},model:{value:t.form.topName,callback:function(e){t.$set(t.form,"topName",e)},expression:"form.topName"}})],1),e("el-form-item",{attrs:{label:"类型","label-width":t.formLabelWidth}},[e("el-select",{attrs:{placeholder:""},model:{value:t.form.topType,callback:function(e){t.$set(t.form,"topType",e)},expression:"form.topType"}},t._l(t.topTypeOption,(function(t,o){return e("el-option",{key:o,attrs:{label:t,value:o}})})),1)],1)],1),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.confirm()}}},[t._v("确 定")])],1)],1)],1)},y=[],I=o(88304);function v(t){return(0,I.W)({url:"/web/apps/gongqi.hsb.elec/elecDrawAction/templateQuery?id="+t,method:"POST"})}function T(t,e,o){return(0,I.W)({url:"/web/apps/gongqi.hsb.elec/elecDrawAction/templateAdd?rationId="+t+"&topName="+e+"&topType="+o,method:"POST"})}function D(t,e,o,i){return(0,I.W)({url:"/web/apps/gongqi.hsb.elec/elecDrawAction/templateUpdate?rationId="+t+"&topName="+e+"&topType="+o+"&recId="+i,method:"POST"})}function F(t){return(0,I.W)({url:"/web/apps/gongqi.hsb.elec/elecDrawAction/templateDelete?recId="+t,method:"POST"})}function k(t){return(0,I.W)({url:"/web/apps/gongqi.hsb.elec/elecDrawAction/paramsQuery?id="+t,method:"POST"})}function $(t){return(0,I.W)({url:"/web/apps/gongqi.hsb.elec/elecDrawAction/paramsAdd",data:t,method:"POST"})}function _(t){return(0,I.W)({url:"/web/apps/gongqi.hsb.elec/elecDrawAction/paramsUpdate",data:t,method:"POST"})}function L(t){return(0,I.W)({url:"/web/apps/gongqi.hsb.elec/elecDrawAction/paramsDelete?recId="+t,method:"POST"})}var S={data(){return{dialogFormVisible:!1,form:{topName:"",topType:""},formLabelWidth:"120px",topTypeOption:["首页园区图","配电图","网络拓扑图","电站布线top图"]}},watch:{dialogFormVisible(t){t||(this.form={topName:"",topType:""})}},mounted(){},methods:{showDialogFunAdd(t){this.dialogFormVisible=!0,this.rationId=t,this.dialogState="add"},showDialogFunEdit(t){this.form={topName:t.topName,topType:t.topType},this.dialogFormVisible=!0,this.editRow=t,this.dialogState="edit"},confirm(){"add"==this.dialogState?this.templateAddFun():this.templateUpdateFun()},templateAddFun(){T(this.rationId,this.form.topName,this.form.topType).then((t=>{const{content:e,errcode:o,errmsg:i}=t;0==o?(this.$message({message:"新增成功",type:"success"}),this.dialogFormVisible=!1,this.form={topName:"",topType:""},this.$bus.$emit("digitalRefresh",!0)):this.$message.error(i)})).catch((t=>{}))},templateUpdateFun(){D(this.editRow.rationId,this.form.topName,this.form.topType,this.editRow.recId).then((t=>{const{content:e,errcode:o,errmsg:i}=t;0==o?(this.$message({message:"修改成功",type:"success"}),this.dialogFormVisible=!1,this.form={topName:"",topType:""},this.$bus.$emit("digitalRefresh",!0)):this.$message.error(i)})).catch((t=>{}))}}},A=S,x=(0,d.Z)(A,w,y,!1,null,"13335180",null),C=x.exports,N=function(){var t=this,e=t._self._c;return e("div",[e("el-dialog",{attrs:{title:"","close-on-click-modal":!1,visible:t.dialogVisible,width:"90%",modal:!1},on:{"update:visible":function(e){t.dialogVisible=e}}},[e("div",{},[e("p",{staticStyle:{"text-align":"right"}},[e("el-button",{staticStyle:{"background-color":"#0066ff",border:"none","margin-bottom":"0.15rem",width:"1.5rem"},attrs:{type:"primary",icon:"el-icon-plus"},on:{click:t.addInfo}},[t._v("新增")])],1),t.tableData?e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,height:"400"}},[e("el-table-column",{attrs:{prop:"topLineId",label:"参数$key"}}),e("el-table-column",{attrs:{prop:"topLineType",label:"类型"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t.getTopTypeName(e.row.topLineType))+" ")]}}],null,!1,3325208899)}),e("el-table-column",{attrs:{prop:"pointId",label:"点位"}}),e("el-table-column",{attrs:{prop:"sQLContent",label:"sql语句",width:"300"}}),e("el-table-column",{attrs:{prop:"measureNo",label:"电力系统设备编号"}}),e("el-table-column",{attrs:{label:"操作",width:"200"},scopedSlots:t._u([{key:"default",fn:function(o){return[e("el-button",{attrs:{type:"text",size:"small"},on:{click:function(e){return t.editInfo(o.row)}}},[t._v("修改")]),e("el-button",{attrs:{type:"text",size:"small"},on:{click:function(e){return t.deleteInfo(o.row)}}},[t._v("删除")])]}}],null,!1,714081346)})],1):t._e()],1)]),e("parameterConfigAdd",{ref:"add"})],1)},V=[],q=function(){var t=this,e=t._self._c;return e("div",[e("el-dialog",{attrs:{title:"",visible:t.dialogFormVisible,modal:!1,top:"17vh"},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[e("p",{staticStyle:{"padding-left":"130px",color:"#fff","text-align":"left","margin-bottom":"10px","font-size":"12px"}},[t._v(" SQL语句规范（表名：JH_PDR_ANAPOINT_DATA_电站IDSTATIONNO_$yearMonth;替换为当前年月，$today;替换为当日，最终select“DATA_VALUE”） ")]),e("el-form",{attrs:{model:t.form}},[e("el-form-item",{attrs:{label:"参数$key","label-width":t.formLabelWidth}},[e("el-input",{attrs:{autocomplete:"off"},model:{value:t.form.topLineId,callback:function(e){t.$set(t.form,"topLineId",e)},expression:"form.topLineId"}})],1),e("el-form-item",{attrs:{label:"类型","label-width":t.formLabelWidth}},[e("el-select",{attrs:{placeholder:""},model:{value:t.form.topLineType,callback:function(e){t.$set(t.form,"topLineType",e)},expression:"form.topLineType"}},t._l(t.topTypeOption,(function(t,o){return e("el-option",{key:o,attrs:{label:t,value:o}})})),1)],1),e("el-form-item",{attrs:{label:"点位","label-width":t.formLabelWidth}},[e("el-input",{attrs:{autocomplete:"off"},model:{value:t.form.pointId,callback:function(e){t.$set(t.form,"pointId",e)},expression:"form.pointId"}})],1),e("el-form-item",{attrs:{label:"sql语句","label-width":t.formLabelWidth}},[e("el-input",{attrs:{autocomplete:"off"},model:{value:t.form.sqlContent,callback:function(e){t.$set(t.form,"sqlContent",e)},expression:"form.sqlContent"}})],1),e("el-form-item",{attrs:{label:"电力系统设备编号","label-width":t.formLabelWidth}},[e("el-input",{attrs:{autocomplete:"off"},model:{value:t.form.measureNo,callback:function(e){t.$set(t.form,"measureNo",e)},expression:"form.measureNo"}})],1)],1),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.confirm()}}},[t._v("确 定")])],1)],1)],1)},W=[],O=(o(46229),o(17330),o(62062),{data(){return{dialogFormVisible:!1,form:{measureNo:"",pointId:"",sqlContent:"",topId:"",topLineId:"",topLineType:""},formLabelWidth:"130px",topTypeOption:["配电房","能源","光伏","sql语句","电力系统"]}},watch:{dialogFormVisible(t){0==t&&(this.form={measureNo:"",pointId:"",sqlContent:"",topId:"",topLineId:"",topLineType:""})}},mounted(){},methods:{showDialogFunAdd(t){this.dialogFormVisible=!0,this.form.topId=t,this.dialogState="add"},showDialogFunEdit(t,e){this.form={measureNo:e.measureNo,pointId:e.pointId,sqlContent:e.sQLContent,topId:t,topLineId:e.topLineId,topLineType:e.topLineType},this.dialogFormVisible=!0,this.editRow=e,this.dialogState="edit"},confirm(){"add"==this.dialogState?this.paramsAddFun():this.paramsUpdateFun()},transformation(t){let e=new URLSearchParams;for(var o in t)e.append(o,t[o]);return e},paramsAddFun(){let t={measureNo:this.form.measureNo,pointId:this.form.pointId,sqlContent:this.form.sqlContent,topId:this.form.topId,topLineId:this.form.topLineId,topLineType:this.form.topLineType},e=this.transformation(t);$(e).then((t=>{const{content:e,errcode:o,errmsg:i}=t;0==o?(this.$message({message:"新增成功",type:"success"}),this.dialogFormVisible=!1,this.$bus.$emit("parameterRefresh",!0)):this.$message.error(i)})).catch((t=>{}))},paramsUpdateFun(){let t={measureNo:this.form.measureNo,pointId:this.form.pointId,sqlContent:this.form.sqlContent,topId:this.form.topId,topLineId:this.form.topLineId,topLineType:this.form.topLineType,recId:this.editRow.recId},e=this.transformation(t);_(e).then((t=>{const{content:e,errcode:o,errmsg:i}=t;0==o?(this.$message({message:"修改成功",type:"success"}),this.dialogFormVisible=!1,this.$bus.$emit("parameterRefresh",!0)):this.$message.error(i)})).catch((t=>{}))}}}),P=O,Q=(0,d.Z)(P,q,W,!1,null,"c203cb34",null),R=Q.exports,E={components:{parameterConfigAdd:R},data(){return{dialogVisible:!1,tableData:[]}},watch:{},created(){this.$bus.$on("parameterRefresh",(t=>{this.paramsQueryFun(this.rowInfo.recId)}))},mounted(){},methods:{showDialogFun(t){this.rowInfo=t,this.dialogVisible=!0,this.paramsQueryFun(t.recId)},paramsQueryFun(t){k(t).then((t=>{const{content:e,errcode:o,errmsg:i}=t;0==o&&(this.tableData=e)})).catch((t=>{}))},addInfo(){this.$refs.add.showDialogFunAdd(this.rowInfo.topId)},editInfo(t){this.$refs.add.showDialogFunEdit(this.rowInfo.topId,t)},deleteInfo(t){this.$alert("确认删除该条信息","",{confirmButtonText:"确定",callback:e=>{this.paramsDeleteFun(t.recId)}})},paramsDeleteFun(t){L(t).then((t=>{const{content:e,errcode:o,errmsg:i}=t;0==o&&(this.$message({message:"删除成功",type:"success"}),this.paramsQueryFun(this.rowInfo.recId))})).catch((t=>{}))},getTopTypeName(t){let e="";return 0==t?e="配电房":1==t?e="能源":2==t?e="光伏":3==t?e="sql语句":4==t&&(e="电力系统"),e}}},U=E,z=(0,d.Z)(U,N,V,!1,null,"0a686f91",null),Z=z.exports,M=o(8745),j={components:{eleDraw:c,digitalTwinAdd:C,parameterConfigDialog:Z,lookEleDraw:b},data(){return{data:[],defaultProps:{children:"children",label:"label"},tableData:[]}},created(){this.$bus.$on("digitalRefresh",(t=>{this.templateQueryFun()}))},mounted(){this.date2=this.date1=this.$getDate().year+"-"+this.$getDate().month+"-"+this.$getDate().day,this.placesFun()},methods:{placesFun(){(0,M.KQ)().then((t=>{let e=t.content,o=!1;e.forEach((t=>{o||(this.areaId=t.id,o=!0)})),this.data=this.$arrToTree(e),this.templateQueryFun()})).catch((t=>{}))},nodeClick(t){this.areaId=t.id,this.templateQueryFun()},toLookParameterConfig(t){this.$refs.lookEleDrawDialog.showDialogFun(t.topId)},draw(t){this.$refs.eleDrawDialog.showDialogFun(t.topId)},templateQueryFun(){v(this.areaId).then((t=>{const{content:e,errcode:o,errmsg:i}=t;0==o&&(this.tableData=e)})).catch((t=>{}))},addInfo(){this.$refs.add.showDialogFunAdd(this.areaId)},editInfo(t){this.$refs.add.showDialogFunEdit(t)},deleteInfo(t){this.$alert("确认删除该条信息","",{confirmButtonText:"确定",callback:e=>{this.templateDeleteFun(t.recId)}})},templateDeleteFun(t){F(t).then((t=>{const{content:e,errcode:o,errmsg:i}=t;0==o&&(this.$message({message:"删除成功",type:"success"}),this.templateQueryFun())})).catch((t=>{}))},toParameterConfig(t){this.$refs.parameterConfig.showDialogFun(t)},getTopTypeName(t){let e="";return 0==t?e="首页园区图":1==t?e="配电图":2==t?e="网络拓扑图":3==t&&(e="电站布线top图"),e}}},B=j,J=(0,d.Z)(B,i,a,!1,null,"741f261a",null),K=J.exports},8745:function(t,e,o){o.d(e,{Jw:function(){return s},KQ:function(){return r},WI:function(){return d},bv:function(){return l},d1:function(){return n},x6:function(){return a}});var i=o(88304);function a(){return(0,i.W)({url:"/web/apps/gongqi.hsb.energy/energyManageAction/places",method:"POST"})}function r(){return(0,i.W)({url:"/web/apps/gongqi.hsb.elec/elecDrawAction/places",method:"POST"})}function l(){return(0,i.W)({method:"POST"})}function n(){return(0,i.W)({url:"/web/apps/gongqi.hsb.pv/pvStationTwoAction/places",method:"POST"})}function s(t,e,o,a,r){return(0,i.W)({url:"/web/apps/gongqi.hsb.energy/energyManageAction/energyTrend?dateType="+t+"&energyType="+e+"&fromDate="+o+"&id="+r+"&toDate="+a,method:"POST"})}function d(t,e,o,a,r){return(0,i.W)({url:"/web/apps/gongqi.hsb.energy/energyManageAction/energyBalance?dateType="+t+"&energyType="+e+"&fromDate="+o+"&id="+r+"&toDate="+a,method:"POST"})}}}]);
//# sourceMappingURL=162.efe2aa91.js.map