"use strict";(self["webpackChunkjinghe"]=self["webpackChunkjinghe"]||[]).push([[636],{20636:function(e,t,a){a.r(t),a.d(t,{default:function(){return d}});var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"energyBalance"},[t("div"),t("div",{staticClass:"right"},[t("div",{staticClass:"search chartSearch"},[t("div",{staticStyle:{"margin-right":"0.2rem"}},[t("span",[e._v("企业")]),t("el-select",{staticStyle:{width:"70%"},attrs:{placeholder:""},on:{change:e.energyFlowToFun},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},e._l(e.options,(function(e){return t("el-option",{key:e.companyId,attrs:{label:e.companyName,value:e.companyId}})})),1)],1),t("div",[t("span",[e._v("能源类型")]),t("el-select",{attrs:{placeholder:""},on:{change:e.energyFlowToFun},model:{value:e.energyVal,callback:function(t){e.energyVal=t},expression:"energyVal"}},e._l(e.energyOption,(function(e){return t("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),t("div",{staticStyle:{"margin-right":"0.2rem"}},[t("el-date-picker",{attrs:{type:"date",placeholder:"","value-format":"yyyy-MM-dd",clearable:!1},on:{change:e.energyFlowToFun},model:{value:e.date1,callback:function(t){e.date1=t},expression:"date1"}})],1),t("div",{staticStyle:{"margin-right":"0.2rem",color:"#00b4fe"}},[e._v("至")]),t("div",[t("el-date-picker",{attrs:{type:"date",placeholder:"","value-format":"yyyy-MM-dd",clearable:!1},on:{change:e.energyFlowToFun},model:{value:e.date2,callback:function(t){e.date2=t},expression:"date2"}})],1)]),t("div",{staticClass:"chart",staticStyle:{"flex-grow":"1","margin-top":"0.2rem"}},[t("div",{ref:"echart",staticStyle:{width:"100%",height:"100%"}})])])])},r=[],o=(a(57658),a(45473)),l={data(){return{date1:"",date2:"",value:"",options:[],energyOption:["电","冷凝水","自来水","蒸汽","天然气","氮气","压缩空气","中水"],energyVal:"电"}},mounted(){this.date2=this.date1=this.$getDate().year+"-"+this.$getDate().month+"-"+this.$getDate().day,this.companyListFun()},methods:{companyListFun(){(0,o.P)().then((e=>{const{content:t,errcode:a,errmsg:n}=e;0==a&&(this.options=t.companyList,this.value=t.companyList[0].companyId,this.energyFlowToFun())})).catch((e=>{}))},energyFlowToFun(){(0,o.o)(this.value,this.energyVal,this.date1,this.date2).then((e=>{const{content:t,errcode:a,errmsg:n}=e;0==a&&this.setEchart(t)})).catch((e=>{}))},setEchart(e){let t=this.treeToArry(e);var a=t.data,n=t.nodes;let r=this.$refs.echart,o=this.$echarts.init(r);o.clear();let l={tooltip:{trigger:"item",triggerOn:"mousemove"},color:["#68C8FF","#EAC11F","#F58B59","#A51FEA","#687DFF","#0042A7"],series:[{type:"sankey",layout:"none",draggable:!1,data:n,links:a,lineStyle:{normal:{curveness:.5,color:"rgba(255,255,255,.8)"}},label:{normal:{color:"#fff"}}}]};o.setOption(l),window.addEventListener("resize",(function(){o.resize()}))},treeToArry(e){let t=[],a=[];function n(e){a.includes(e.name)||a.push(e.name),e.list.length>0&&e.list.forEach((r=>{t.push({source:e.name,target:r.name,value:r.elec}),a.includes(r.name)||a.push(r.name),r.list&&r.list.length>0&&n(r)}))}n(e);let r=[];return a.forEach((e=>{r.push({name:e})})),{data:t,nodes:r}}}},i=l,s=a(1001),c=(0,s.Z)(i,n,r,!1,null,"d4a10b16",null),d=c.exports},45473:function(e,t,a){a.d(t,{P:function(){return r},o:function(){return o}});var n=a(88304);function r(){return(0,n.W)({url:"/web/apps/gongqi.hsb.energy/energyManageAction/companyList?areaId="+sessionStorage.getItem("companyId"),method:"POST"})}function o(e,t,a,r){return(0,n.W)({url:"/web/apps/gongqi.hsb.energy/energyManageAction/energyFlowTo?companyId="+e+"&energyType="+t+"&fromDate="+a+"&toDate="+r,method:"POST"})}}}]);
//# sourceMappingURL=636.404853dd.js.map